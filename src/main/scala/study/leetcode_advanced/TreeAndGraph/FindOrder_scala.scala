package study.leetcode_advanced.TreeAndGraph

import scala.collection.mutable
import scala.collection.mutable.{ArrayBuffer, ListBuffer}

object FindOrder_scala {
  //拓扑排序
  def findOrder(numCourses: Int, prerequisites: Array[Array[Int]]): Array[Int] = {
    val indegree = new Array[Int](numCourses)
    val graph = collection.mutable.Map[Int, ArrayBuffer[Int]]()

    for (i <- prerequisites.indices) {
      graph += prerequisites(i)(1) -> (graph.getOrElse(prerequisites(i)(1), ArrayBuffer[Int]()) += prerequisites(i)(0))
      indegree(prerequisites(i)(0)) += 1
    }
    val res = ListBuffer[Int]()
    for (i <- 0 until numCourses; j <- 0 until numCourses) {
      if (indegree(j) == 0) {
        res += j
        indegree(j) = -1
        val next = graph.getOrElse(j, ArrayBuffer())
        for (k <- next.indices if next.nonEmpty) {
          indegree(next(k)) -= 1
        }
      }
    }
    if (res.length == numCourses)
      res.toArray
    else
      Array[Int]()
  }

  //优化后的拓扑排序  (bfs,kahn)
  def findOrder2(numCourses: Int, prerequisites: Array[Array[Int]]): Array[Int] = {
    val indegree = new Array[Int](numCourses)
    val graph = collection.mutable.Map[Int, ArrayBuffer[Int]]()
    for (i <- prerequisites.indices) {
      graph += prerequisites(i)(1) -> (graph.getOrElse(prerequisites(i)(1), ArrayBuffer[Int]()) += prerequisites(i)(0))
      indegree(prerequisites(i)(0)) += 1
    }

    val queue = mutable.Queue[Int]()
    for (i <- indegree.indices if indegree(i) == 0) {
      queue.enqueue(i)
    }
    val res = ListBuffer[Int]()
    while (queue.nonEmpty) {
      val t = queue.dequeue()
      res += t
      val list = graph.getOrElse(t, ArrayBuffer())
      list.foreach {
        x =>
          indegree(x) -= 1
          if (indegree(x) == 0)
            queue.enqueue(x)
      }
    }
    if (res.length == numCourses)
      res.toArray
    else
      Array[Int]()
  }

  //dfs方法，将queue改为stack
  def findOrder3(numCourses: Int, prerequisites: Array[Array[Int]]): Array[Int] = {
    val indegree = new Array[Int](numCourses)
    val graph = collection.mutable.Map[Int, ListBuffer[Int]]()
    for (i <- prerequisites.indices) {
      graph += prerequisites(i)(1) -> (graph.getOrElse(prerequisites(i)(1), ListBuffer[Int]()) += prerequisites(i)(0))
      indegree(prerequisites(i)(0)) += 1
    }

    val stack = mutable.Stack[Int]()
    for (i <- indegree.indices if indegree(i) == 0)
      stack.push(i)

    val res = ListBuffer[Int]()
    while (stack.nonEmpty) {
      val t = stack.pop()
      res += t
      val list = graph.getOrElse(t, ListBuffer())
      list.foreach {
        x =>
          indegree(x) -= 1
          if (indegree(x) == 0)
            stack.push(x)
      }
    }
    if(res.length == numCourses)
      res.toArray
    else
      Array[Int]()

  }

  def main(args: Array[String]): Unit = {
    //    val res = new FindOrder().findOrder(2, Array(Array(1, 0)))
        val res = findOrder3(2, Array(Array(1, 0)))
res.foreach(println)
    /**
      * 两种方法测试
      */
    //    val testArr = Array(Array(781, 650), Array(650, 1175), Array(1175, 1961), Array(1961, 1414), Array(1414, 1144), Array(1144, 461), Array(461, 1450), Array(1450, 1836), Array(1836, 754), Array(754, 1429), Array(1429, 97), Array(97, 385), Array(385, 1260), Array(1260, 1345), Array(1345, 1751), Array(1751, 1775), Array(1775, 1273), Array(1273, 18), Array(18, 1307), Array(1307, 859), Array(859, 1792), Array(1792, 1258), Array(1258, 1609), Array(1609, 999), Array(999, 1485), Array(1485, 887), Array(887, 82), Array(82, 285), Array(285, 1026), Array(1026, 1442), Array(1442, 328), Array(328, 224), Array(224, 33), Array(33, 1687), Array(1687, 1797), Array(1797, 510), Array(510, 1266), Array(1266, 1984), Array(1984, 314), Array(314, 1314), Array(1314, 67), Array(67, 375), Array(375, 1969), Array(1969, 560), Array(560, 1466), Array(1466, 1362), Array(1362, 1672), Array(1672, 1657), Array(1657, 1323), Array(1323, 114), Array(114, 745), Array(745, 1455), Array(1455, 1306), Array(1306, 241), Array(241, 960), Array(960, 271), Array(271, 57), Array(57, 324), Array(324, 400), Array(400, 609), Array(609, 721), Array(721, 1387), Array(1387, 793), Array(793, 482), Array(482, 873), Array(873, 311), Array(311, 833), Array(833, 637), Array(637, 491), Array(491, 886), Array(886, 1426), Array(1426, 201), Array(201, 1740), Array(1740, 183), Array(183, 1706), Array(1706, 626), Array(626, 546), Array(546, 318), Array(318, 903), Array(903, 1979), Array(1979, 69), Array(69, 472), Array(472, 16), Array(16, 576), Array(576, 1370), Array(1370, 1691), Array(1691, 665), Array(665, 256), Array(256, 1884), Array(1884, 548), Array(548, 28), Array(28, 176), Array(176, 252), Array(252, 1105), Array(1105, 274), Array(274, 1721), Array(1721, 1718), Array(1718, 906), Array(906, 852), Array(852, 1435), Array(1435, 865), Array(865, 896), Array(896, 699), Array(699, 1156), Array(1156, 259), Array(259, 1399), Array(1399, 740), Array(740, 673), Array(673, 622), Array(622, 984), Array(984, 794), Array(794, 963), Array(963, 1753), Array(1753, 1454), Array(1454, 1017), Array(1017, 1636), Array(1636, 627), Array(627, 1498), Array(1498, 1628), Array(1628, 628), Array(628, 513), Array(513, 1044), Array(1044, 1564), Array(1564, 933), Array(933, 653), Array(653, 1401), Array(1401, 909), Array(909, 1768), Array(1768, 840), Array(840, 1749), Array(1749, 554), Array(554, 1326), Array(1326, 1931), Array(1931, 844), Array(844, 645), Array(645, 1592), Array(1592, 1183), Array(1183, 306), Array(306, 1949), Array(1949, 1970), Array(1970, 1680), Array(1680, 27), Array(27, 1329), Array(1329, 277), Array(277, 354), Array(354, 612), Array(612, 1844), Array(1844, 1389), Array(1389, 550), Array(550, 1291), Array(1291, 1524), Array(1524, 686), Array(686, 688), Array(688, 1845), Array(1845, 448), Array(448, 730), Array(730, 1603), Array(1603, 185), Array(185, 109), Array(109, 591), Array(591, 1159), Array(1159, 1919), Array(1919, 380), Array(380, 719), Array(719, 728), Array(728, 1873), Array(1873, 1093), Array(1093, 969), Array(969, 1798), Array(1798, 1413), Array(1413, 492), Array(492, 365), Array(365, 1988), Array(1988, 695), Array(695, 14), Array(14, 773), Array(773, 177), Array(177, 1720), Array(1720, 1964), Array(1964, 1432), Array(1432, 1187), Array(1187, 1479), Array(1479, 784), Array(784, 118), Array(118, 741), Array(741, 967), Array(967, 1641), Array(1641, 490), Array(490, 966), Array(966, 1591), Array(1591, 1778), Array(1778, 1576), Array(1576, 1615), Array(1615, 723), Array(723, 1724), Array(1724, 1954), Array(1954, 1709), Array(1709, 96), Array(96, 1486), Array(1486, 1642), Array(1642, 1776), Array(1776, 994), Array(994, 1758), Array(1758, 1983), Array(1983, 483), Array(483, 917), Array(917, 738), Array(738, 1428), Array(1428, 1852), Array(1852, 1648), Array(1648, 1953), Array(1953, 155), Array(155, 181), Array(181, 815), Array(815, 1180), Array(1180, 1666), Array(1666, 88), Array(88, 1226), Array(1226, 876), Array(876, 1179), Array(1179, 251), Array(251, 720), Array(720, 1073), Array(1073, 1042), Array(1042, 1599), Array(1599, 102), Array(102, 372), Array(372, 466), Array(466, 636), Array(636, 1892), Array(1892, 620), Array(620, 164), Array(164, 866), Array(866, 1646), Array(1646, 1253), Array(1253, 467), Array(467, 1342), Array(1342, 1584), Array(1584, 540), Array(540, 1104), Array(1104, 543), Array(543, 1677), Array(1677, 529), Array(529, 1705), Array(1705, 429), Array(429, 1606), Array(1606, 1202), Array(1202, 1886), Array(1886, 508), Array(508, 883), Array(883, 694), Array(694, 1542), Array(1542, 1774), Array(1774, 371), Array(371, 1586), Array(1586, 414), Array(414, 1877), Array(1877, 1398), Array(1398, 1182), Array(1182, 644), Array(644, 809), Array(809, 890), Array(890, 1035), Array(1035, 390), Array(390, 1671), Array(1671, 970), Array(970, 756), Array(756, 1267), Array(1267, 1332), Array(1332, 158), Array(158, 1587), Array(1587, 1940), Array(1940, 475), Array(475, 478), Array(478, 1206), Array(1206, 590), Array(590, 1731), Array(1731, 573), Array(573, 392), Array(392, 1728), Array(1728, 281), Array(281, 1834), Array(1834, 404), Array(404, 1471), Array(1471, 615), Array(615, 1109), Array(1109, 621), Array(621, 1861), Array(1861, 925), Array(925, 1874), Array(1874, 1882), Array(1882, 1013), Array(1013, 1367), Array(1367, 1660), Array(1660, 1380), Array(1380, 243), Array(243, 722), Array(722, 668), Array(668, 1526), Array(1526, 1855), Array(1855, 1118), Array(1118, 1243), Array(1243, 128), Array(128, 1842), Array(1842, 1178), Array(1178, 1472), Array(1472, 370), Array(370, 1437), Array(1437, 1274), Array(1274, 434), Array(434, 1782), Array(1782, 511), Array(511, 402), Array(402, 1982), Array(1982, 1875), Array(1875, 703), Array(703, 1131), Array(1131, 1085), Array(1085, 1034), Array(1034, 1181), Array(1181, 1467), Array(1467, 556), Array(556, 139), Array(139, 298), Array(298, 1440), Array(1440, 1298), Array(1298, 1899), Array(1899, 1978), Array(1978, 1217), Array(1217, 1951), Array(1951, 1683), Array(1683, 1280), Array(1280, 1204), Array(1204, 405), Array(405, 99), Array(99, 1448), Array(1448, 162), Array(162, 1112), Array(1112, 1157), Array(1157, 1929), Array(1929, 1890), Array(1890, 1926), Array(1926, 1302), Array(1302, 1425), Array(1425, 1699), Array(1699, 565), Array(565, 1627), Array(1627, 1483), Array(1483, 1676), Array(1676, 66), Array(66, 1116), Array(1116, 986), Array(986, 1041), Array(1041, 62), Array(62, 1818), Array(1818, 1888), Array(1888, 355), Array(355, 266), Array(266, 431), Array(431, 1218), Array(1218, 1763), Array(1763, 115), Array(115, 997), Array(997, 1099), Array(1099, 936), Array(936, 249), Array(249, 1704), Array(1704, 930), Array(930, 1560), Array(1560, 1230), Array(1230, 646), Array(646, 144), Array(144, 1059), Array(1059, 1506), Array(1506, 791), Array(791, 811), Array(811, 1427), Array(1427, 595), Array(595, 413), Array(413, 1800), Array(1800, 399), Array(399, 299), Array(299, 1902), Array(1902, 1679), Array(1679, 1871), Array(1871, 87), Array(87, 1914), Array(1914, 260), Array(260, 361), Array(361, 1726), Array(1726, 1880), Array(1880, 200), Array(200, 1225), Array(1225, 1772), Array(1772, 1608), Array(1608, 1866), Array(1866, 1346), Array(1346, 538), Array(538, 669), Array(669, 1000), Array(1000, 1190), Array(1190, 330), Array(330, 1434), Array(1434, 1896), Array(1896, 117), Array(117, 1779), Array(1779, 836), Array(836, 1692), Array(1692, 1386), Array(1386, 417), Array(417, 596), Array(596, 1993), Array(1993, 422), Array(422, 1248), Array(1248, 928), Array(928, 253), Array(253, 1012), Array(1012, 457), Array(457, 1991), Array(1991, 1412), Array(1412, 1801), Array(1801, 1127), Array(1127, 1331), Array(1331, 1920), Array(1920, 1945), Array(1945, 671), Array(671, 1837), Array(1837, 317), Array(317, 301), Array(301, 335), Array(335, 1674), Array(1674, 1121), Array(1121, 1921), Array(1921, 1198), Array(1198, 411), Array(411, 1152), Array(1152, 1277), Array(1277, 1912), Array(1912, 586), Array(586, 310), Array(310, 1525), Array(1525, 1174), Array(1174, 1254), Array(1254, 284), Array(284, 1103), Array(1103, 1350), Array(1350, 1396), Array(1396, 835), Array(835, 1509), Array(1509, 1275), Array(1275, 127), Array(127, 206), Array(206, 188), Array(188, 1960), Array(1960, 980), Array(980, 1122), Array(1122, 77), Array(77, 31), Array(31, 652), Array(652, 1507), Array(1507, 386), Array(386, 655), Array(655, 129), Array(129, 1215), Array(1215, 1552), Array(1552, 1620), Array(1620, 1616), Array(1616, 696), Array(696, 1223), Array(1223, 1719), Array(1719, 1548), Array(1548, 455), Array(455, 920), Array(920, 1601), Array(1601, 1421), Array(1421, 509), Array(509, 257), Array(257, 1007), Array(1007, 680), Array(680, 675), Array(675, 240), Array(240, 1682), Array(1682, 661), Array(661, 484), Array(484, 327), Array(327, 132), Array(132, 1518), Array(1518, 1827), Array(1827, 687), Array(687, 195), Array(195, 1027), Array(1027, 469), Array(469, 752), Array(752, 566), Array(566, 280), Array(280, 796), Array(796, 104), Array(104, 142), Array(142, 750), Array(750, 957), Array(957, 425), Array(425, 1272), Array(1272, 239), Array(239, 1446), Array(1446, 1208), Array(1208, 888), Array(888, 1585), Array(1585, 1655), Array(1655, 391), Array(391, 1905), Array(1905, 1697), Array(1697, 972), Array(972, 1166), Array(1166, 101), Array(101, 65), Array(65, 727), Array(727, 797), Array(797, 1795), Array(1795, 1972), Array(1972, 1808), Array(1808, 558), Array(558, 1745), Array(1745, 1813), Array(1813, 296), Array(296, 826), Array(826, 1901), Array(1901, 12), Array(12, 683), Array(683, 1110), Array(1110, 1312), Array(1312, 1725), Array(1725, 685), Array(685, 691), Array(691, 407), Array(407, 1147), Array(1147, 1809), Array(1809, 1965), Array(1965, 332), Array(332, 1785), Array(1785, 393), Array(393, 639), Array(639, 998), Array(998, 976), Array(976, 1381), Array(1381, 1349), Array(1349, 1402), Array(1402, 60), Array(60, 154), Array(154, 93), Array(93, 1784), Array(1784, 1384), Array(1384, 351), Array(351, 1959), Array(1959, 1826), Array(1826, 855), Array(855, 843), Array(843, 1072), Array(1072, 1865), Array(1865, 1805), Array(1805, 1231), Array(1231, 1600), Array(1600, 1517), Array(1517, 394), Array(394, 850), Array(850, 1742), Array(1742, 789), Array(789, 442), Array(442, 4), Array(4, 169), Array(169, 838), Array(838, 631), Array(631, 915), Array(915, 932), Array(932, 604), Array(604, 1997), Array(1997, 1995), Array(1995, 230), Array(230, 1799), Array(1799, 309), Array(309, 1209), Array(1209, 1541), Array(1541, 707), Array(707, 90), Array(90, 1288), Array(1288, 1487), Array(1487, 885), Array(885, 146), Array(146, 1256), Array(1256, 137), Array(137, 901), Array(901, 520), Array(520, 746), Array(746, 148), Array(148, 1911), Array(1911, 1673), Array(1673, 772), Array(772, 597), Array(597, 856), Array(856, 61), Array(61, 1503), Array(1503, 507), Array(507, 1568), Array(1568, 288), Array(288, 40), Array(40, 996), Array(996, 401), Array(401, 1461), Array(1461, 1464), Array(1464, 46), Array(46, 1240), Array(1240, 20), Array(20, 1743), Array(1743, 1065), Array(1065, 1056), Array(1056, 79), Array(79, 1579), Array(1579, 1261), Array(1261, 44), Array(44, 767), Array(767, 1932), Array(1932, 292), Array(292, 373), Array(373, 1734), Array(1734, 1968), Array(1968, 1385), Array(1385, 1501), Array(1501, 321), Array(321, 1605), Array(1605, 350), Array(350, 1786), Array(1786, 598), Array(598, 803), Array(803, 1018), Array(1018, 198), Array(198, 757), Array(757, 486), Array(486, 468), Array(468, 893), Array(893, 924), Array(924, 1573), Array(1573, 126), Array(126, 783), Array(783, 1299), Array(1299, 1358), Array(1358, 26), Array(26, 1263), Array(1263, 758), Array(758, 1014), Array(1014, 927), Array(927, 130), Array(130, 729), Array(729, 473), Array(473, 1321), Array(1321, 202), Array(202, 210), Array(210, 1693), Array(1693, 657), Array(657, 1259), Array(1259, 1430), Array(1430, 1328), Array(1328, 1108), Array(1108, 534), Array(534, 1863), Array(1863, 555), Array(555, 1347), Array(1347, 1392), Array(1392, 1575), Array(1575, 710), Array(710, 654), Array(654, 1079), Array(1079, 1224), Array(1224, 171), Array(171, 1251), Array(1251, 1352), Array(1352, 1141), Array(1141, 945), Array(945, 1058), Array(1058, 1172), Array(1172, 1746), Array(1746, 449), Array(449, 1610), Array(1610, 493), Array(493, 1955), Array(1955, 503), Array(503, 450), Array(450, 1717), Array(1717, 1950), Array(1950, 1638), Array(1638, 1069), Array(1069, 419), Array(419, 170), Array(170, 816), Array(816, 152), Array(152, 362), Array(362, 1958), Array(1958, 1005), Array(1005, 813), Array(813, 1213), Array(1213, 956), Array(956, 1216), Array(1216, 1747), Array(1747, 1153), Array(1153, 1815), Array(1815, 1031), Array(1031, 1074), Array(1074, 428), Array(428, 625), Array(625, 708), Array(708, 1364), Array(1364, 1102), Array(1102, 857), Array(857, 795), Array(795, 1824), Array(1824, 1935), Array(1935, 1284), Array(1284, 1419), Array(1419, 717), Array(717, 1094), Array(1094, 23), Array(23, 81), Array(81, 1310), Array(1310, 1624), Array(1624, 701), Array(701, 131), Array(131, 541), Array(541, 1702), Array(1702, 1545), Array(1545, 1322), Array(1322, 270), Array(270, 49), Array(49, 742), Array(742, 1145), Array(1145, 726), Array(726, 1372), Array(1372, 1476), Array(1476, 1249), Array(1249, 1228), Array(1228, 1810), Array(1810, 1571), Array(1571, 1986), Array(1986, 1851), Array(1851, 1171), Array(1171, 1802), Array(1802, 1028), Array(1028, 1030), Array(1030, 1126), Array(1126, 1054), Array(1054, 1091), Array(1091, 278), Array(278, 762), Array(762, 824), Array(824, 1481), Array(1481, 1378), Array(1378, 136), Array(136, 755), Array(755, 764), Array(764, 216), Array(216, 905), Array(905, 1977), Array(1977, 982), Array(982, 1055), Array(1055, 1357), Array(1357, 1265), Array(1265, 1546), Array(1546, 1872), Array(1872, 379), Array(379, 1701), Array(1701, 398), Array(398, 1645), Array(1645, 437), Array(437, 1535), Array(1535, 1904), Array(1904, 78), Array(78, 1612), Array(1612, 1668), Array(1668, 245), Array(245, 849), Array(849, 83), Array(83, 954), Array(954, 1558), Array(1558, 1494), Array(1494, 1239), Array(1239, 964), Array(964, 825), Array(825, 1375), Array(1375, 821), Array(821, 68), Array(68, 1443), Array(1443, 869), Array(869, 123), Array(123, 470), Array(470, 1647), Array(1647, 1513), Array(1513, 329), Array(329, 1004), Array(1004, 800), Array(800, 517), Array(517, 34), Array(34, 423), Array(423, 634), Array(634, 562), Array(562, 273), Array(273, 1770), Array(1770, 1316), Array(1316, 713), Array(713, 978), Array(978, 315), Array(315, 1678), Array(1678, 1848), Array(1848, 1077), Array(1077, 1536), Array(1536, 500), Array(500, 662), Array(662, 1910), Array(1910, 147), Array(147, 585), Array(585, 777), Array(777, 235), Array(235, 421), Array(421, 1733), Array(1733, 22), Array(22, 1214), Array(1214, 1344), Array(1344, 297), Array(297, 1803), Array(1803, 1849), Array(1849, 874), Array(874, 1879), Array(1879, 934), Array(934, 955), Array(955, 831), Array(831, 348), Array(348, 1057), Array(1057, 1011), Array(1011, 1024), Array(1024, 219), Array(219, 1097), Array(1097, 539), Array(539, 870), Array(870, 1351), Array(1351, 810), Array(810, 363), Array(363, 487), Array(487, 218), Array(218, 454), Array(454, 1956), Array(1956, 1651), Array(1651, 841), Array(841, 480), Array(480, 262), Array(262, 1893), Array(1893, 1941), Array(1941, 1359), Array(1359, 356), Array(356, 347), Array(347, 1083), Array(1083, 1821), Array(1821, 1478), Array(1478, 180), Array(180, 247), Array(247, 333), Array(333, 1468), Array(1468, 771), Array(771, 931), Array(931, 1830), Array(1830, 1390), Array(1390, 232), Array(232, 1080), Array(1080, 322), Array(322, 537), Array(537, 1822), Array(1822, 1595), Array(1595, 666), Array(666, 1823), Array(1823, 248), Array(248, 1368), Array(1368, 1741), Array(1741, 3), Array(3, 1451), Array(1451, 618), Array(618, 1626), Array(1626, 718), Array(718, 939), Array(939, 184), Array(184, 1337), Array(1337, 806), Array(806, 1029), Array(1029, 374), Array(374, 11), Array(11, 189), Array(189, 947), Array(947, 1066), Array(1066, 1046), Array(1046, 640), Array(640, 124), Array(124, 1976), Array(1976, 420), Array(420, 462), Array(462, 670), Array(670, 1037), Array(1037, 456), Array(456, 276), Array(276, 89), Array(89, 904), Array(904, 140), Array(140, 1895), Array(1895, 1395), Array(1395, 1563), Array(1563, 1191), Array(1191, 246), Array(246, 1459), Array(1459, 851), Array(851, 1439), Array(1439, 1766), Array(1766, 92), Array(92, 1582), Array(1582, 1520), Array(1520, 705), Array(705, 54), Array(54, 884), Array(884, 743), Array(743, 1832), Array(1832, 1710), Array(1710, 410), Array(410, 1916), Array(1916, 1045), Array(1045, 1010), Array(1010, 443), Array(443, 15), Array(15, 1247), Array(1247, 1788), Array(1788, 55), Array(55, 549), Array(549, 1232), Array(1232, 1416), Array(1416, 225), Array(225, 8), Array(8, 1529), Array(1529, 1148), Array(1148, 353), Array(353, 1860), Array(1860, 376), Array(376, 531), Array(531, 339), Array(339, 418), Array(418, 250), Array(250, 733), Array(733, 325), Array(325, 258), Array(258, 599), Array(599, 951), Array(951, 1730), Array(1730, 959), Array(959, 1658), Array(1658, 331), Array(331, 571), Array(571, 1319), Array(1319, 1762), Array(1762, 551), Array(551, 269), Array(269, 1363), Array(1363, 261), Array(261, 121), Array(121, 837), Array(837, 842), Array(842, 961), Array(961, 1688), Array(1688, 808), Array(808, 1137), Array(1137, 1143), Array(1143, 220), Array(220, 1990), Array(1990, 1760), Array(1760, 760), Array(760, 1114), Array(1114, 1164), Array(1164, 1493), Array(1493, 921), Array(921, 1870), Array(1870, 496), Array(496, 731), Array(731, 1767), Array(1767, 1759), Array(1759, 1499), Array(1499, 1068), Array(1068, 697), Array(697, 914), Array(914, 1169), Array(1169, 1296), Array(1296, 190), Array(190, 1405), Array(1405, 474), Array(474, 435), Array(435, 192), Array(192, 149), Array(149, 412), Array(412, 1151), Array(1151, 494), Array(494, 1379), Array(1379, 1020), Array(1020, 1295), Array(1295, 1233), Array(1233, 608), Array(608, 145), Array(145, 74), Array(74, 1246), Array(1246, 846), Array(846, 438), Array(438, 263), Array(263, 1167), Array(1167, 1534), Array(1534, 895), Array(895, 1820), Array(1820, 1282), Array(1282, 1936), Array(1936, 582), Array(582, 1474), Array(1474, 1285), Array(1285, 396), Array(396, 120), Array(120, 698), Array(698, 1407), Array(1407, 1071), Array(1071, 593), Array(593, 944), Array(944, 1197), Array(1197, 1947), Array(1947, 1161), Array(1161, 938), Array(938, 1796), Array(1796, 340), Array(340, 1470), Array(1470, 971), Array(971, 1376), Array(1376, 1989), Array(1989, 1107), Array(1107, 1092), Array(1092, 197), Array(197, 1039), Array(1039, 1480), Array(1480, 215), Array(215, 1445), Array(1445, 1052), Array(1052, 1420), Array(1420, 1739), Array(1739, 525), Array(525, 1854), Array(1854, 1257), Array(1257, 937), Array(937, 165), Array(165, 1033), Array(1033, 1212), Array(1212, 568), Array(568, 763), Array(763, 313), Array(313, 1681), Array(1681, 1653), Array(1653, 1637), Array(1637, 207), Array(207, 1264), Array(1264, 953), Array(953, 1580), Array(1580, 415), Array(415, 388), Array(388, 110), Array(110, 168), Array(168, 1562), Array(1562, 1944), Array(1944, 822), Array(822, 897), Array(897, 1447), Array(1447, 1355), Array(1355, 871), Array(871, 1812), Array(1812, 1075), Array(1075, 1076), Array(1076, 161), Array(161, 656), Array(656, 1356), Array(1356, 1294), Array(1294, 203), Array(203, 10), Array(10, 383), Array(383, 236), Array(236, 1100), Array(1100, 1317), Array(1317, 294), Array(294, 1348), Array(1348, 1089), Array(1089, 302), Array(302, 209), Array(209, 1279), Array(1279, 1369), Array(1369, 572), Array(572, 1095), Array(1095, 1975), Array(1975, 64), Array(64, 95), Array(95, 1814), Array(1814, 725), Array(725, 1611), Array(1611, 1783), Array(1783, 1130), Array(1130, 1334), Array(1334, 1639), Array(1639, 275), Array(275, 759), Array(759, 463), Array(463, 689), Array(689, 227), Array(227, 1806), Array(1806, 1971), Array(1971, 975), Array(975, 1828), Array(1828, 1557), Array(1557, 1889), Array(1889, 1188), Array(1188, 501), Array(501, 1406), Array(1406, 291), Array(291, 968), Array(968, 366), Array(366, 1003), Array(1003, 1135), Array(1135, 1623), Array(1623, 589), Array(589, 488), Array(488, 1366), Array(1366, 1781), Array(1781, 51), Array(51, 610), Array(610, 526), Array(526, 135), Array(135, 747), Array(747, 1962), Array(1962, 1192), Array(1192, 312), Array(312, 1134), Array(1134, 349), Array(349, 912), Array(912, 732), Array(732, 1908), Array(1908, 1394), Array(1394, 1723), Array(1723, 820), Array(820, 616), Array(616, 926), Array(926, 1773), Array(1773, 624), Array(624, 868), Array(868, 660), Array(660, 563), Array(563, 1942), Array(1942, 1883), Array(1883, 319), Array(319, 1619), Array(1619, 39), Array(39, 1465), Array(1465, 962), Array(962, 1160), Array(1160, 606), Array(606, 406), Array(406, 1839), Array(1839, 711), Array(711, 58), Array(58, 1021), Array(1021, 775), Array(775, 1339), Array(1339, 38), Array(38, 231), Array(231, 1925), Array(1925, 119), Array(119, 1881), Array(1881, 1829), Array(1829, 532), Array(532, 1128), Array(1128, 561), Array(561, 41), Array(41, 533), Array(533, 1735), Array(1735, 802), Array(802, 32), Array(32, 858), Array(858, 1640), Array(1640, 459), Array(459, 1907), Array(1907, 1318), Array(1318, 875), Array(875, 1195), Array(1195, 545), Array(545, 1566), Array(1566, 1514), Array(1514, 958), Array(958, 1484), Array(1484, 1550), Array(1550, 1196), Array(1196, 1869), Array(1869, 35), Array(35, 228), Array(228, 217), Array(217, 950), Array(950, 1165), Array(1165, 1594), Array(1594, 502), Array(502, 444), Array(444, 1900), Array(1900, 337), Array(337, 1088), Array(1088, 635), Array(635, 84), Array(84, 1974), Array(1974, 471), Array(471, 94), Array(94, 676), Array(676, 178), Array(178, 1793), Array(1793, 48), Array(48, 73), Array(73, 1409), Array(1409, 1523), Array(1523, 734), Array(734, 191), Array(191, 382), Array(382, 577), Array(577, 642), Array(642, 899), Array(899, 1186), Array(1186, 1711), Array(1711, 965), Array(965, 56), Array(56, 1670), Array(1670, 1868), Array(1868, 580), Array(580, 268), Array(268, 436), Array(436, 1001), Array(1001, 212), Array(212, 1238), Array(1238, 514), Array(514, 1185), Array(1185, 1857), Array(1857, 1732), Array(1732, 1897), Array(1897, 432), Array(432, 1096), Array(1096, 1393), Array(1393, 1597), Array(1597, 516), Array(516, 1664), Array(1664, 163), Array(163, 1305), Array(1305, 326), Array(326, 748), Array(748, 1549), Array(1549, 922), Array(922, 1937), Array(1937, 1635), Array(1635, 787), Array(787, 575), Array(575, 1244), Array(1244, 693), Array(693, 735), Array(735, 369), Array(369, 1533), Array(1533, 427), Array(427, 1111), Array(1111, 892), Array(892, 1512), Array(1512, 681), Array(681, 774), Array(774, 1570), Array(1570, 807), Array(807, 141), Array(141, 1700), Array(1700, 1939), Array(1939, 1755), Array(1755, 17), Array(17, 1938), Array(1938, 1200), Array(1200, 1761), Array(1761, 1722), Array(1722, 1168), Array(1168, 1098), Array(1098, 780), Array(780, 714), Array(714, 1604), Array(1604, 343), Array(343, 1631), Array(1631, 433), Array(433, 1449), Array(1449, 293), Array(293, 515), Array(515, 1572), Array(1572, 103), Array(103, 1790), Array(1790, 408), Array(408, 1819), Array(1819, 1287), Array(1287, 860), Array(860, 557), Array(557, 910), Array(910, 105), Array(105, 283), Array(283, 1583), Array(1583, 174), Array(174, 559), Array(559, 1155), Array(1155, 804), Array(804, 611), Array(611, 1923), Array(1923, 1173), Array(1173, 613), Array(613, 761), Array(761, 1853), Array(1853, 913), Array(913, 1113), Array(1113, 1738), Array(1738, 766), Array(766, 194), Array(194, 1675), Array(1675, 1876), Array(1876, 1696), Array(1696, 649), Array(649, 829), Array(829, 583), Array(583, 946), Array(946, 1515), Array(1515, 658), Array(658, 1227), Array(1227, 1124), Array(1124, 1453), Array(1453, 416), Array(416, 1544), Array(1544, 667), Array(667, 1555), Array(1555, 1522), Array(1522, 736), Array(736, 1132), Array(1132, 1538), Array(1538, 290), Array(290, 1933), Array(1933, 1343), Array(1343, 1490), Array(1490, 864), Array(864, 1150), Array(1150, 221), Array(221, 853), Array(853, 264), Array(264, 607), Array(607, 1106), Array(1106, 1325), Array(1325, 700), Array(700, 1120), Array(1120, 1613), Array(1613, 1521), Array(1521, 122), Array(122, 1189), Array(1189, 175), Array(175, 205), Array(205, 1360), Array(1360, 1708), Array(1708, 1617), Array(1617, 1750), Array(1750, 1530), Array(1530, 113), Array(113, 854), Array(854, 1707), Array(1707, 504), Array(504, 1162), Array(1162, 907), Array(907, 24), Array(24, 481), Array(481, 902), Array(902, 1374), Array(1374, 588), Array(588, 587), Array(587, 877), Array(877, 1577), Array(1577, 682), Array(682, 1505), Array(1505, 564), Array(564, 630), Array(630, 439), Array(439, 1043), Array(1043, 702), Array(702, 1569), Array(1569, 1553), Array(1553, 527), Array(527, 138), Array(138, 1777), Array(1777, 1694), Array(1694, 724), Array(724, 569), Array(569, 1841), Array(1841, 812), Array(812, 574), Array(574, 1744), Array(1744, 1492), Array(1492, 1669), Array(1669, 1327), Array(1327, 1308), Array(1308, 1237), Array(1237, 769), Array(769, 304), Array(304, 1444), Array(1444, 1115), Array(1115, 242), Array(242, 1062), Array(1062, 948), Array(948, 1353), Array(1353, 1270), Array(1270, 1622), Array(1622, 552), Array(552, 1496), Array(1496, 1748), Array(1748, 159), Array(159, 542), Array(542, 739), Array(739, 1025), Array(1025, 1510), Array(1510, 1400), Array(1400, 1408), Array(1408, 1867), Array(1867, 991), Array(991, 830), Array(830, 1008), Array(1008, 715), Array(715, 553), Array(553, 1320), Array(1320, 1729), Array(1729, 1262), Array(1262, 1061), Array(1061, 182), Array(182, 1654), Array(1654, 238), Array(238, 1154), Array(1154, 709), Array(709, 1686), Array(1686, 663), Array(663, 633), Array(633, 1462), Array(1462, 1593), Array(1593, 579), Array(579, 1690), Array(1690, 987), Array(987, 267), Array(267, 614), Array(614, 1999), Array(1999, 1365), Array(1365, 91), Array(91, 1927), Array(1927, 1002), Array(1002, 479), Array(479, 1987), Array(1987, 768), Array(768, 153), Array(153, 993), Array(993, 156), Array(156, 1438), Array(1438, 1081), Array(1081, 1596), Array(1596, 30), Array(30, 1913), Array(1913, 497), Array(497, 1), Array(1, 1539), Array(1539, 1219), Array(1219, 845), Array(845, 338), Array(338, 1885), Array(1885, 387), Array(387, 1023), Array(1023, 744), Array(744, 1630), Array(1630, 106), Array(106, 1292), Array(1292, 286), Array(286, 1915), Array(1915, 919), Array(919, 45), Array(45, 889), Array(889, 706), Array(706, 1255), Array(1255, 506), Array(506, 1831), Array(1831, 1661), Array(1661, 1221), Array(1221, 166), Array(166, 1194), Array(1194, 952), Array(952, 677), Array(677, 1847), Array(1847, 1423), Array(1423, 1397), Array(1397, 76), Array(76, 303), Array(303, 1946), Array(1946, 1229), Array(1229, 799), Array(799, 1527), Array(1527, 451), Array(451, 1887), Array(1887, 287), Array(287, 523), Array(523, 1441), Array(1441, 1060), Array(1060, 1698), Array(1698, 1540), Array(1540, 476), Array(476, 13), Array(13, 578), Array(578, 1737), Array(1737, 211), Array(211, 229), Array(229, 1241), Array(1241, 1417), Array(1417, 839), Array(839, 1771), Array(1771, 1765), Array(1765, 1313), Array(1313, 1422), Array(1422, 818), Array(818, 1607), Array(1607, 623), Array(623, 1431), Array(1431, 112), Array(112, 1036), Array(1036, 1878), Array(1878, 237), Array(237, 1543), Array(1543, 1482), Array(1482, 908), Array(908, 307), Array(307, 368), Array(368, 1146), Array(1146, 834), Array(834, 1504), Array(1504, 1268), Array(1268, 521), Array(521, 1650), Array(1650, 819), Array(819, 651), Array(651, 1551), Array(1551, 0), Array(0, 133), Array(133, 1567), Array(1567, 1304), Array(1304, 1994), Array(1994, 765), Array(765, 1090), Array(1090, 308), Array(308, 222), Array(222, 1966), Array(1966, 2), Array(2, 1290), Array(1290, 678), Array(678, 1477), Array(1477, 1193), Array(1193, 1754), Array(1754, 1403), Array(1403, 1163), Array(1163, 1922), Array(1922, 1210), Array(1210, 530), Array(530, 1032), Array(1032, 1391), Array(1391, 1278), Array(1278, 1588), Array(1588, 316), Array(316, 1667), Array(1667, 300), Array(300, 395), Array(395, 63), Array(63, 918), Array(918, 47), Array(47, 272), Array(272, 495), Array(495, 848), Array(848, 1663), Array(1663, 1727), Array(1727, 601), Array(601, 1361), Array(1361, 498), Array(498, 1574), Array(1574, 941), Array(941, 1757), Array(1757, 1457), Array(1457, 1040), Array(1040, 485), Array(485, 878), Array(878, 1864), Array(1864, 323), Array(323, 1201), Array(1201, 1811), Array(1811, 1473), Array(1473, 1621), Array(1621, 1858), Array(1858, 1078), Array(1078, 1335), Array(1335, 684), Array(684, 1756), Array(1756, 367), Array(367, 1303), Array(1303, 1590), Array(1590, 1764), Array(1764, 524), Array(524, 426), Array(426, 1415), Array(1415, 1340), Array(1340, 1082), Array(1082, 916), Array(916, 1176), Array(1176, 1311), Array(1311, 1614), Array(1614, 751), Array(751, 1333), Array(1333, 1906), Array(1906, 1684), Array(1684, 1377), Array(1377, 477), Array(477, 1589), Array(1589, 85), Array(85, 1125), Array(1125, 157), Array(157, 1140), Array(1140, 1315), Array(1315, 1338), Array(1338, 359), Array(359, 1136), Array(1136, 244), Array(244, 1158), Array(1158, 150), Array(150, 1411), Array(1411, 1245), Array(1245, 1371), Array(1371, 1250), Array(1250, 1794), Array(1794, 847), Array(847, 1502), Array(1502, 381), Array(381, 42), Array(42, 295), Array(295, 632), Array(632, 1963), Array(1963, 1475), Array(1475, 692), Array(692, 1336), Array(1336, 1006), Array(1006, 25), Array(25, 770), Array(770, 567), Array(567, 704), Array(704, 345), Array(345, 254), Array(254, 1211), Array(1211, 160), Array(160, 995), Array(995, 397), Array(397, 992), Array(992, 1980), Array(1980, 187), Array(187, 1086), Array(1086, 801), Array(801, 1271), Array(1271, 1047), Array(1047, 1511), Array(1511, 1843), Array(1843, 792), Array(792, 1038), Array(1038, 464), Array(464, 59), Array(59, 1769), Array(1769, 643), Array(643, 753), Array(753, 52), Array(52, 1957), Array(1957, 974), Array(974, 1662), Array(1662, 1497), Array(1497, 1559), Array(1559, 75), Array(75, 1424), Array(1424, 70), Array(70, 80), Array(80, 430), Array(430, 208), Array(208, 1460), Array(1460, 584), Array(584, 346), Array(346, 358), Array(358, 1301), Array(1301, 629), Array(629, 1404), Array(1404, 1625), Array(1625, 894), Array(894, 776), Array(776, 378), Array(378, 1602), Array(1602, 1410), Array(1410, 282), Array(282, 21), Array(21, 6), Array(6, 1207), Array(1207, 458), Array(458, 409), Array(409, 1632), Array(1632, 1500), Array(1500, 1659), Array(1659, 1495), Array(1495, 779), Array(779, 377), Array(377, 179), Array(179, 1050), Array(1050, 1714), Array(1714, 364), Array(364, 1469), Array(1469, 881), Array(881, 424), Array(424, 489), Array(489, 389), Array(389, 1203), Array(1203, 213), Array(213, 641), Array(641, 143), Array(143, 1433), Array(1433, 1488), Array(1488, 535), Array(535, 1452), Array(1452, 167), Array(167, 226), Array(226, 1652), Array(1652, 647), Array(647, 460), Array(460, 499), Array(499, 872), Array(872, 1133), Array(1133, 1064), Array(1064, 1516), Array(1516, 1791), Array(1791, 882), Array(882, 452), Array(452, 53), Array(53, 778), Array(778, 1184), Array(1184, 547), Array(547, 505), Array(505, 900), Array(900, 1943), Array(1943, 125), Array(125, 1780), Array(1780, 1894), Array(1894, 1634), Array(1634, 1324), Array(1324, 679), Array(679, 1856), Array(1856, 1649), Array(1649, 863), Array(863, 536), Array(536, 1051), Array(1051, 107), Array(107, 1300), Array(1300, 1531), Array(1531, 204), Array(204, 1289), Array(1289, 37), Array(37, 1547), Array(1547, 43), Array(43, 1491), Array(1491, 223), Array(223, 1063), Array(1063, 929), Array(929, 1934), Array(1934, 522), Array(522, 600), Array(600, 172), Array(172, 544), Array(544, 1928), Array(1928, 71), Array(71, 1170), Array(1170, 1629), Array(1629, 1236), Array(1236, 279), Array(279, 1918), Array(1918, 1101), Array(1101, 1016), Array(1016, 749), Array(749, 1862), Array(1862, 602), Array(602, 827), Array(827, 1685), Array(1685, 342), Array(342, 1787), Array(1787, 672), Array(672, 985), Array(985, 1456), Array(1456, 664), Array(664, 1598), Array(1598, 1850), Array(1850, 1924), Array(1924, 352), Array(352, 1199), Array(1199, 1252), Array(1252, 1436), Array(1436, 1656), Array(1656, 1807), Array(1807, 942), Array(942, 619), Array(619, 116), Array(116, 1985), Array(1985, 1556), Array(1556, 1581), Array(1581, 879), Array(879, 981), Array(981, 186), Array(186, 570), Array(570, 737), Array(737, 1528), Array(1528, 786), Array(786, 1070), Array(1070, 234), Array(234, 440), Array(440, 1293), Array(1293, 1117), Array(1117, 193), Array(193, 1220), Array(1220, 1129), Array(1129, 1418), Array(1418, 1618), Array(1618, 384), Array(384, 1269), Array(1269, 108), Array(108, 1833), Array(1833, 199), Array(199, 233), Array(233, 19), Array(19, 360), Array(360, 798), Array(798, 214), Array(214, 465), Array(465, 5), Array(5, 9), Array(9, 1840), Array(1840, 1388), Array(1388, 690), Array(690, 817), Array(817, 1508), Array(1508, 1142), Array(1142, 403), Array(403, 1903), Array(1903, 36), Array(36, 86), Array(86, 898), Array(898, 1695), Array(1695, 1909), Array(1909, 1891), Array(1891, 1752), Array(1752, 528), Array(528, 1222), Array(1222, 1859), Array(1859, 1015), Array(1015, 441), Array(441, 949), Array(949, 1330), Array(1330, 716), Array(716, 1382), Array(1382, 1713), Array(1713, 1463), Array(1463, 1235), Array(1235, 1917), Array(1917, 1712), Array(1712, 1458), Array(1458, 1123), Array(1123, 1898), Array(1898, 289), Array(289, 1578), Array(1578, 1846), Array(1846, 1789), Array(1789, 1665), Array(1665, 1009), Array(1009, 990), Array(990, 790), Array(790, 1736), Array(1736, 973), Array(973, 453), Array(453, 1177), Array(1177, 674), Array(674, 1537), Array(1537, 1689), Array(1689, 196), Array(196, 832), Array(832, 935), Array(935, 940), Array(940, 445), Array(445, 518), Array(518, 1139), Array(1139, 265), Array(265, 1973), Array(1973, 828), Array(828, 1967), Array(1967, 1309), Array(1309, 1242), Array(1242, 1373), Array(1373, 1554), Array(1554, 782), Array(782, 1565), Array(1565, 659), Array(659, 1149), Array(1149, 1716), Array(1716, 72), Array(72, 98), Array(98, 1276), Array(1276, 983), Array(983, 305), Array(305, 867), Array(867, 862), Array(862, 594), Array(594, 1948), Array(1948, 1354), Array(1354, 1138), Array(1138, 447), Array(447, 805), Array(805, 1998), Array(1998, 1084), Array(1084, 603), Array(603, 134), Array(134, 1825), Array(1825, 617), Array(617, 1992), Array(1992, 979), Array(979, 1053), Array(1053, 814), Array(814, 1804), Array(1804, 1561), Array(1561, 1835), Array(1835, 911), Array(911, 1341), Array(1341, 341), Array(341, 1489), Array(1489, 334), Array(334, 712), Array(712, 1297), Array(1297, 1383), Array(1383, 648), Array(648, 50), Array(50, 1067), Array(1067, 1048), Array(1048, 1633), Array(1633, 151), Array(151, 943), Array(943, 1022), Array(1022, 7), Array(7, 1816), Array(1816, 788), Array(788, 861), Array(861, 988), Array(988, 1234), Array(1234, 1952), Array(1952, 1715), Array(1715, 1283), Array(1283, 446), Array(446, 1703), Array(1703, 923), Array(923, 255), Array(255, 1119), Array(1119, 357), Array(357, 1930), Array(1930, 173), Array(173, 1281), Array(1281, 1644), Array(1644, 605), Array(605, 1019), Array(1019, 1286), Array(1286, 638), Array(638, 891), Array(891, 29), Array(29, 519), Array(519, 1532), Array(1532, 1519), Array(1519, 1087), Array(1087, 581), Array(581, 1981), Array(1981, 336), Array(336, 785), Array(785, 1205), Array(1205, 989), Array(989, 1817), Array(1817, 512), Array(512, 592), Array(592, 1838), Array(1838, 977), Array(977, 1049), Array(1049, 320), Array(320, 880), Array(880, 823), Array(823, 1643), Array(1643, 1996), Array(1996, 100), Array(100, 111), Array(111, 344), Array(344, 781))
    //    val start = System.currentTimeMillis()
    //    val res = findOrder(2000, testArr)
    //    val end = System.currentTimeMillis()
    //    res.foreach(println)
    //    println("time: " + (end - start))
    //
    //    val start2 = System.currentTimeMillis()
    //    val res2 = findOrder2(2000, testArr)
    //    val end2 = System.currentTimeMillis()
    //    res2.foreach(println)
    //    println("time: " + (end2 - start2))

    //    time: 453
    //    time: 15
  }
}
